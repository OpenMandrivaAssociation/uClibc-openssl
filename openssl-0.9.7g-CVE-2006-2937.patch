--- openssl-0.9.7g/crypto/asn1/tasn_dec.c.cve-2006-2937	2003-09-30 06:05:43.000000000 -0600
+++ openssl-0.9.7g/crypto/asn1/tasn_dec.c	2006-09-26 14:42:36.000000000 -0600
@@ -628,6 +628,9 @@ static int asn1_d2i_ex_primitive(ASN1_VA
 		ASN1err(ASN1_F_ASN1_D2I_EX_PRIMITIVE, ERR_R_NESTED_ASN1_ERROR);
 		return 0;
 	} else if(ret == -1) return -1;
+
+	ret = 0;
+	
 	/* SEQUENCE, SET and "OTHER" are left in encoded form */
 	if((utype == V_ASN1_SEQUENCE) || (utype == V_ASN1_SET) || (utype == V_ASN1_OTHER)) {
 		/* Clear context cache for type OTHER because the auto clear when
